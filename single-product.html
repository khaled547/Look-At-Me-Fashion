<!DOCTYPE html>
<html lang="bn">

<head>
  <meta charset="UTF-8" />
  <title>Product Details - Look At Me Fashion</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1" />

  <!-- Premium Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />

  <!-- Tailwind CSS -->
  <link href="src/output.css" rel="stylesheet" />

  <style>
    body {
      font-family: "Inter", "Poppins", sans-serif;
      -webkit-font-smoothing: antialiased;
      -webkit-tap-highlight-color: transparent;
      background-color: #fff7f7;
    }
  </style>
</head>

<body class="bg-red-50 text-gray-900 antialiased">

  <!-- ================= HEADER ================= -->
  <header class="sticky top-0 z-50 bg-white/95 backdrop-blur border-b border-red-200 shadow-sm">
    <nav class="max-w-7xl mx-auto px-4 lg:px-8 flex items-center justify-between py-3">

      <a href="index.html">
        <div class="bg-[#6B0000] px-4 py-1.5 rounded-lg shadow">
          <span class="text-[#FFD600] font-extrabold text-xs sm:text-lg tracking-wide">
            LOOK AT ME FASHION
          </span>
        </div>
      </a>

      <a href="products.html"
        class="text-xs sm:text-sm font-semibold text-[#6B0000]
               border border-[#FFD600] bg-[#FFD600]/80 px-3 py-1.5 rounded-full
               hover:bg-[#FFD600] transition">
        ‚Üê Back to Products
      </a>

    </nav>
  </header>

  <!-- ================= MAIN ================= -->
  <main class="max-w-7xl mx-auto px-4 lg:px-8 py-7 md:py-10 space-y-6">

    <!-- ===== BREADCRUMB + TITLE ===== -->
    <section class="space-y-3">
      <nav class="text-xs sm:text-sm text-gray-600 flex items-center gap-1">
        <a href="index.html" class="hover:text-[#6B0000] font-medium">Home</a>
        <span>/</span>
        <a href="products.html" class="hover:text-[#6B0000] font-medium">Products</a>
        <span>/</span>
        <span id="breadcrumbProductName" class="font-semibold text-[#6B0000]">Loading‚Ä¶</span>
      </nav>

      <div class="flex flex-col sm:flex-row sm:justify-between gap-2">
        <h1 id="pageTitle"
          class="text-2xl sm:text-3xl md:text-4xl font-extrabold text-[#6B0000]">
          Product Details
        </h1>

        <span id="productCategoryBadge"
          class="hidden px-3 py-1 rounded-full bg-[#FFD600]/80 text-[#6B0000]
                 text-xs sm:text-sm font-semibold border border-[#FFD600]">
          Category: <span id="productCategoryText"></span>
        </span>
      </div>
    </section>

    <!-- ===== PRODUCT DETAILS BOX ===== -->
    <section id="productSection"
      class="bg-white rounded-2xl shadow-sm border border-red-100 p-4 sm:p-6 md:p-8">

      <!-- Loading -->
      <div id="productLoading" class="text-center py-10 text-gray-500 text-sm">
        Loading product details...
      </div>

      <!-- Error -->
      <div id="productError"
        class="hidden text-center py-10 text-red-600 text-sm font-semibold">
        Failed to load product!
      </div>

      <!-- ===== CONTENT (IMAGE + DETAILS) ===== -->
      <div id="productContent"
        class="hidden grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">

        <!-- IMAGE -->
        <div>
          <div class="rounded-2xl overflow-hidden shadow border border-red-100">
            <div class="aspect-[4/5] bg-gray-100 overflow-hidden">
              <img id="productImage"
                   class="w-full h-full object-cover transition-transform duration-700 hover:scale-105" />
            </div>
          </div>
        </div>

        <!-- DETAILS -->
        <div class="space-y-5">

          <h2 id="productName"
            class="text-xl sm:text-2xl md:text-3xl font-extrabold text-[#6B0000] leading-snug">
          </h2>

          <p id="productPrice"
            class="text-3xl font-extrabold text-[#6B0000]"></p>

          <p id="productDescription"
            class="text-sm sm:text-base text-gray-700 leading-relaxed"></p>

          <button id="addToCartBtn"
            class="w-full sm:w-auto px-7 py-3 rounded-full bg-[#FFD600]
                   text-[#6B0000] font-bold shadow border border-[#FFD600]
                   hover:bg-white transition active:scale-95">
            üõí Add to Cart
          </button>

        </div>
      </div>

    </section>

    <!-- ===== RELATED PRODUCTS ===== -->
    <section class="pb-12">
      <h3 class="text-lg sm:text-xl font-extrabold text-[#6B0000] mb-3">Related Products</h3>

      <div id="relatedContainer"
        class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></div>

      <p id="relatedEmpty" class="hidden text-gray-500 text-sm mt-2">
        No related products found.
      </p>
    </section>

  </main>

  <!-- ===== TOAST ===== -->
  <div id="cartToast"
    class="fixed bottom-6 right-6 bg-[#6B0000] text-[#FFD600]
           text-sm px-4 py-2 rounded-full shadow-lg opacity-0
           pointer-events-none transition-all duration-300">
    Added to cart
  </div>

  <!-- ========== INLINE JS (PREMIUM + COMMENTED) ========== -->
  <script>
    /*
      =====================================================
      SINGLE PRODUCT PAGE LOGIC
      =====================================================
      ‚úî URL ‡¶•‡ßá‡¶ï‡ßá product ID ‡¶®‡ßá‡¶ì‡ßü‡¶æ
      ‚úî API ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶¨ ‡¶™‡¶£‡ßç‡¶Ø ‡¶´‡ßá‡¶ö ‡¶ï‡¶∞‡¶æ
      ‚úî Match ‡¶ï‡¶∞‡ßá details show ‡¶ï‡¶∞‡¶æ
      ‚úî Add to cart (localStorage)
      ‚úî Toast animation
      ‚úî Related products ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
    */

    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");

    const API_URL = "http://localhost:5000/api/products";

    // UI Elements
    const breadcrumbName = document.getElementById("breadcrumbProductName");
    const pageTitle = document.getElementById("pageTitle");

    const loadingBox = document.getElementById("productLoading");
    const errorBox = document.getElementById("productError");
    const contentBox = document.getElementById("productContent");

    const imgEl = document.getElementById("productImage");
    const nameEl = document.getElementById("productName");
    const priceEl = document.getElementById("productPrice");
    const descEl = document.getElementById("productDescription");

    const catBadge = document.getElementById("productCategoryBadge");
    const catText = document.getElementById("productCategoryText");

    const relatedBox = document.getElementById("relatedContainer");
    const relatedEmpty = document.getElementById("relatedEmpty");
    const addBtn = document.getElementById("addToCartBtn");

    const toast = document.getElementById("cartToast");

    // Invalid URL
    if (!productId) {
      showError("Invalid product link.");
    }

    // Fetch all products
    fetch(API_URL)
      .then(res => res.json())
      .then(products => {
        const product = products.find(p => p._id === productId);

        if (!product) return showError("Product not found.");

        renderProduct(product);
        renderRelated(products, product);
      })
      .catch(() => showError("Unable to load product."));

    // Show Error Box
    function showError(msg) {
      loadingBox.classList.add("hidden");
      contentBox.classList.add("hidden");
      errorBox.textContent = msg;
      errorBox.classList.remove("hidden");
    }

    // Render Main Product
    function renderProduct(p) {
      loadingBox.classList.add("hidden");
      contentBox.classList.remove("hidden");

      breadcrumbName.textContent = p.name;
      pageTitle.textContent = p.name;

      imgEl.src = `image/${p.image}`;
      nameEl.textContent = p.name;
      priceEl.textContent = `‡ß≥ ${p.price}`;
      descEl.textContent = p.description || "No description available.";

      catText.textContent = p.category || "Uncategorized";
      catBadge.classList.remove("hidden");

      // Add to cart event
      addBtn.addEventListener("click", () => {
        addToCart(p);
        showToast();
      });
    }

    // Add to Cart
    function addToCart(p) {
      let cart = JSON.parse(localStorage.getItem("lmf_cart") || "[]");

      const index = cart.findIndex(item => item.id === p._id);

      if (index >= 0) {
        cart[index].qty++;
      } else {
        cart.push({
          id: p._id,
          name: p.name,
          price: p.price,
          image: p.image,
          qty: 1
        });
      }

      localStorage.setItem("lmf_cart", JSON.stringify(cart));
    }

    // Toast
    function showToast() {
      toast.classList.remove("opacity-0", "pointer-events-none");
      toast.classList.add("opacity-100");

      setTimeout(() => {
        toast.classList.remove("opacity-100");
        toast.classList.add("opacity-0", "pointer-events-none");
      }, 1800);
    }

    // Render Related Products
    function renderRelated(all, current) {
      const related = all.filter(
        x => x.category === current.category && x._id !== current._id
      );

      if (related.length === 0) {
        relatedEmpty.classList.remove("hidden");
        return;
      }

      relatedBox.innerHTML = "";
      related.slice(0, 4).forEach(p => {
        const card = document.createElement("a");
        card.href = `single-product.html?id=${p._id}`;
        card.className =
          "bg-white rounded-2xl shadow-sm border border-red-100 overflow-hidden" +
          " hover:shadow-lg transition active:scale-95";

        card.innerHTML = `
          <div class="aspect-[4/5] bg-gray-100 overflow-hidden">
            <img src="image/${p.image}"
                 class="w-full h-full object-cover hover:scale-105 transition" />
          </div>
          <div class="p-3">
            <h4 class="font-semibold text-sm line-clamp-2">${p.name}</h4>
            <p class="text-[#6B0000] font-bold">‡ß≥ ${p.price}</p>
          </div>
        `;
        relatedBox.appendChild(card);
      });
    }

  </script>

</body>
</html>


