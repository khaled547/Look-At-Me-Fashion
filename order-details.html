<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>Order Details - Look At Me Fashion</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Premium Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&
    family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />

  <!-- Tailwind CSS -->
  <link href="src/output.css" rel="stylesheet" />

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #fff5f5;
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>

<body class="text-gray-900">

  <!-- ===================================================== -->
  <!-- HEADER (Premium Sticky Header) -->
  <!-- ===================================================== -->
  <header class="sticky top-0 bg-white/95 backdrop-blur shadow border-b border-red-200 z-50">
    <nav class="max-w-7xl mx-auto px-4 lg:px-8 py-3 flex justify-between items-center">

      <a href="index.html" class="active:scale-95 transition">
        <div class="bg-[#6B0000] px-4 py-1.5 rounded-lg shadow">
          <span class="text-[#FFD600] font-extrabold text-xs sm:text-lg">
            LOOK AT ME FASHION
          </span>
        </div>
      </a>

      <a href="my-orders.html"
        class="text-xs sm:text-sm font-semibold text-[#6B0000]
               border border-[#FFD600] bg-[#FFD600]/80 px-3 py-1.5 rounded-full
               hover:bg-[#FFD600] active:scale-95 transition">
        ‚Üê Back to Orders
      </a>

    </nav>
  </header>



  <!-- ===================================================== -->
  <!-- MAIN SECTION -->
  <!-- ===================================================== -->
  <main class="max-w-3xl mx-auto px-4 lg:px-8 py-8">

    <h1 class="text-3xl sm:text-4xl font-extrabold text-[#6B0000] mb-6">
      Order Details üßæ
    </h1>

    <!-- LOADING -->
    <div id="loading"
         class="text-center text-gray-500 py-12 text-sm animate-pulse">
      Loading order details...
    </div>

    <!-- ERROR BOX -->
    <div id="errorBox"
         class="hidden bg-white border border-red-300 text-center py-12 rounded-2xl shadow text-red-600 font-semibold">
      Failed to load order details ‚ùå
    </div>

    <!-- ORDER DETAILS CONTENT -->
    <div id="orderBox" class="hidden space-y-6">


      <!-- ======================= ORDER SUMMARY ======================= -->
      <div class="bg-white border border-red-200 rounded-2xl shadow p-6">

        <h2 class="text-xl font-bold text-[#6B0000] mb-4">Order Summary</h2>

        <p class="text-sm"><strong>Order ID:</strong> <span id="oId"></span></p>

        <p class="text-sm flex items-center gap-1">
          <strong>Status:</strong>
          <span id="oStatus"
                class="px-3 py-1 text-xs rounded-full font-bold border">
          </span>
        </p>

        <p class="text-sm"><strong>Date:</strong> <span id="oDate"></span></p>
        <p class="text-sm"><strong>Phone:</strong> <span id="oPhone"></span></p>
        <p class="text-sm"><strong>Address:</strong> <span id="oAddress"></span></p>

        <p class="text-lg font-bold text-[#6B0000] mt-4">
          Total: ‡ß≥ <span id="oTotal"></span>
        </p>

      </div>



      <!-- ======================= ORDERED ITEMS ======================= -->
      <div class="bg-white border border-red-200 rounded-2xl shadow p-6">

        <h2 class="text-xl font-bold text-[#6B0000] mb-4">Ordered Items</h2>

        <div id="itemsList" class="space-y-3"></div>

      </div>

    </div>

  </main>



  <!-- ===================================================== -->
  <!-- INLINE JAVASCRIPT (Clean + Explained + Professional) -->
  <!-- ===================================================== -->
  <script>

    /*==========================================================
      AUTH CHECK
    ==========================================================*/
    const token = localStorage.getItem("lmf_token");
    if (!token) window.location.href = "login.html";

    /*==========================================================
      GET ORDER ID FROM URL
    ==========================================================*/
    const orderId = new URLSearchParams(window.location.search).get("id");

    /* DOM ELEMENTS */
    const loading = document.getElementById("loading");
    const errorBox = document.getElementById("errorBox");
    const orderBox = document.getElementById("orderBox");

    const oId = document.getElementById("oId");
    const oStatus = document.getElementById("oStatus");
    const oDate = document.getElementById("oDate");
    const oPhone = document.getElementById("oPhone");
    const oAddress = document.getElementById("oAddress");
    const oTotal = document.getElementById("oTotal");
    const itemsList = document.getElementById("itemsList");

    const API = "http://localhost:5000/api/orders/order";


    /*==========================================================
      LOAD ORDER DETAILS FROM BACKEND
      ---------------------------------------------------------
      ‚úî Fetch with token
      ‚úî Error handling
      ‚úî Premium UI mapping
      ‚úî Dynamic badge color
    ==========================================================*/
    async function loadOrder() {
      try {
        const res = await fetch(`${API}/${orderId}`, {
          headers: { "Authorization": `Bearer ${token}` }
        });

        const data = await res.json();

        loading.classList.add("hidden");

        if (!res.ok) {
          errorBox.classList.remove("hidden");
          return;
        }

        orderBox.classList.remove("hidden");

        /*--------------------- Fill Summary Info ---------------------*/
        oId.textContent = orderId.slice(-6).toUpperCase();
        oPhone.textContent = data.phone || "N/A";
        oAddress.textContent = data.address || "Not Provided";
        oTotal.textContent = data.total || 0;

        /*--------------------- Status Badge Styling ---------------------*/
        const status = data.status?.toLowerCase() || "pending";
        oStatus.textContent = status.toUpperCase();

        let colorClass =
          status === "pending"
            ? "bg-yellow-100 text-yellow-700 border-yellow-300"
            : status === "processing"
            ? "bg-blue-100 text-blue-700 border-blue-300"
            : status === "completed"
            ? "bg-green-100 text-green-700 border-green-300"
            : "bg-red-100 text-red-700 border-red-300";

        oStatus.className = `px-3 py-1 text-xs rounded-full font-bold border ${colorClass}`;

        /*--------------------- Date Format ---------------------*/
        oDate.textContent = new Date(data.createdAt)
          .toLocaleDateString("bn-BD");

        /*--------------------- Render Ordered Items ---------------------*/
        itemsList.innerHTML = "";

        data.items?.forEach(item => {
          const div = document.createElement("div");

          div.className =
            "flex gap-3 border border-red-100 rounded-xl p-3 bg-white " +
            "hover:bg-red-50 transition shadow-sm";

          div.innerHTML = `
            <img src="image/${item.image}"
                 onerror="this.src='https://via.placeholder.com/80'"
                 class="w-16 h-16 rounded-lg object-cover border"/>

            <div class="flex-1">
              <p class="font-semibold text-sm">${item.name}</p>
              <p class="text-xs text-gray-500">Qty: ${item.qty}</p>
            </div>

            <p class="font-bold text-[#6B0000] text-sm">
              ‡ß≥ ${item.price}
            </p>
          `;

          itemsList.appendChild(div);
        });

      } catch (err) {
        console.error(err);
        loading.textContent = "Failed to load order details.";
      }
    }

    loadOrder();
  </script>

</body>
</html>

</html>
